import{M as T}from"./assets/constants.js";console.log("[v0] Content script loaded");chrome.runtime.onMessage.addListener((t,n,e)=>{var o;return t.type==="TOGGLE_ZEN_MODE"&&(M((o=t.payload)==null?void 0:o.preset),e({success:!0})),!0});document.addEventListener("DOMContentLoaded",async()=>{await p()});(document.readyState==="complete"||document.readyState==="interactive")&&p();async function p(){try{const t=document.body.innerText.slice(0,T),n=window.location.href,e=await h(t,n);chrome.runtime.sendMessage({type:"CONTENT_ANALYSIS_RESULT",payload:e}),console.log("[v0] Content analyzed:",e.classification)}catch(t){console.error("[v0] Error analyzing content:",t)}}async function h(t,n){const{settings:e}=await chrome.storage.sync.get("settings"),o=(e==null?void 0:e.productiveKeywords)||[],a=(e==null?void 0:e.distractingKeywords)||[],y=t.toLowerCase();let i=0,s=0;o.forEach(u=>{const m=new RegExp(`\\b${u}\\b`,"gi"),c=y.match(m);c&&(i+=c.length)}),a.forEach(u=>{const m=new RegExp(`\\b${u}\\b`,"gi"),c=y.match(m);c&&(s+=c.length)});const g=i+s,d=g>0?s/g:0;let l="neutral";return d>.6?l="distracting":d<.4&&i>0&&(l="productive"),{url:n,classification:l,score:d,timestamp:Date.now()}}let f=!1,r=null;function M(t){f?(r&&(document.body.innerHTML=r,r=null),f=!1,console.log("[v0] Zen Mode deactivated")):(r=document.body.innerHTML,v(t),f=!0,console.log("[v0] Zen Mode activated"))}function v(t){const n=w();t&&E(t);const e=document.createElement("div");e.id="zen-mode-container",e.style.cssText=`
    max-width: 800px;
    margin: 0 auto;
    padding: 40px 20px;
    font-family: Georgia, serif;
    font-size: 18px;
    line-height: 1.6;
    color: #333;
    background: #fff;
  `,e.innerHTML=n,document.body.innerHTML="",document.body.appendChild(e),document.body.style.background="#f5f5f5"}function w(){const t=document.querySelector("article"),n=document.querySelector("main"),e=document.querySelector('[role="main"]');return t?t.innerHTML:n?n.innerHTML:e?e.innerHTML:document.body.innerHTML}async function E(t){const{zenModePresets:n}=await chrome.storage.local.get("zenModePresets"),e=n==null?void 0:n.find(o=>o.domain===t);e!=null&&e.selectorsToRemove&&e.selectorsToRemove.forEach(o=>{document.querySelectorAll(o).forEach(a=>a.remove())})}
